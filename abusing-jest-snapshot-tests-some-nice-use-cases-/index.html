<!DOCTYPE html>
<html lang="en-US" />
<head>
    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="google-site-verification" content="gBfbdXRLofaOyHsbgiSiuCIHKPaviGMRVWh_qOfDHNE" />

    <title>When to use Jest snapshot tests: comprehensive use-cases and examples 📸 &middot; Code with Hugo</title>

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#00aba9">
    <meta name="theme-color" content="#090a0b">

    <link rel="shortcut icon" href="https://codewithhugo.com/favicon.ico" />
    <meta name="theme-color" content="#090a0b">
    
    <link rel="canonical" href="https://codewithhugo.com/abusing-jest-snapshot-tests-some-nice-use-cases-/" /> 

     <meta name="description" content="There&amp;rsquo;s some nice use-cases for snapshot tests outside of the well-travelled React/Vue UI component ones.
In other words, although React and Vue testing w" /> 

     
    
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:image" content="https://codewithhugo.com/img/ben-sauer-unsplash.jpg"/>
    
 
    <meta name="twitter:title" content="When to use Jest snapshot tests: comprehensive use-cases and examples 📸"/>
    <meta name="twitter:description" content="There&amp;rsquo;s some nice use-cases for snapshot tests outside of the well-travelled React/Vue UI component ones.
In other words, although React and Vue testing w"/>
    <meta name="twitter:url" content="https://codewithhugo.com/abusing-jest-snapshot-tests-some-nice-use-cases-/" />
    <meta name="twitter:site" content="@hugo__df"/>

    <meta property="og:site_name" content="Code with Hugo" />
    <meta property="og:title" content="When to use Jest snapshot tests: comprehensive use-cases and examples 📸 &middot; Code with Hugo" />
    <meta property="og:url" content="https://codewithhugo.com/abusing-jest-snapshot-tests-some-nice-use-cases-/" />
    

    <meta property="og:type" content="article" />
    <meta property="og:description" content="There&amp;rsquo;s some nice use-cases for snapshot tests outside of the well-travelled React/Vue UI component ones.
In other words, although React and Vue testing w" />

    <meta property="article:published_time" content="2018-08-10T00:00:00Z" />
    <meta property="article:tag" content="Testing" /><meta property="article:tag" content="JavaScript" /><meta property="article:tag" content="ES6" />

    <meta property="og:image" content="https://codewithhugo.com/img/ben-sauer-unsplash.jpg"/>


    <meta name="generator" content="Hugo 0.46" />

    <!-- Stylesheets -->
    <link rel="stylesheet" type="text/css" href="https://codewithhugo.com/built/screen.css" />
    <link rel="stylesheet" type="text/css" href="https://codewithhugo.com/css/casper-two.css" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" />
    
      
      <link rel="stylesheet" href="https://codewithhugo.com/overrides.min.bd35cf74c58c56c4aa8eff40730357744dec20ff31d8bae7b0618dbe30e0dbe4.css">
    
      
      <link rel="stylesheet" href="https://codewithhugo.com/syntax.min.e1646a3f88f77e1b5e7d0253633b1958013aa132890dfe4d7e15dc4718d4aecc.css">
    
      
      <link rel="stylesheet" href="https://codewithhugo.com/cta.min.612120dbcad38a206f6cc18996cd1f7d45141911bf04c86ab0c6132a55274b7b.css">
    

    

     
</head>


<body class="post-template">
  <div class="site-wrapper"> 

<header class="site-header outer">
  <div class="inner">
    <nav class="site-nav">
      <div class="site-nav-left">

        <ul class="nav" role="menu">
        
        
        
            <li class="" role="menuitem">
              <a href="/">Home</a>
            </li>
        
            <li class="" role="menuitem">
              <a href="/tags/">Categories</a>
            </li>
        
            <li class="" role="menuitem">
              <a href="/guides/">guides</a>
            </li>
        
            <li class="" role="menuitem">
              <a href="/tags/javascript/">JavaScript</a>
            </li>
        
            <li class="" role="menuitem">
              <a href="/tags/node/">Node</a>
            </li>
        
            <li class="" role="menuitem">
              <a href="/tags/sequelize/">Sequelize</a>
            </li>
        
            <li class="" role="menuitem">
              <a href="/tags/deployment/">Deployment</a>
            </li>
        
            <li class="" role="menuitem">
              <a href="/open/">#open</a>
            </li>
        
      </ul></div>

      <div class="site-nav-right">
        <div class="social-links">
                    

                    <a class="social-link social-link-tw" href="https://twitter.com/hugo__df" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg></a>

                    <a class="social-link" href="https://github.com/HugoDF" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a>

                    

                    <a class="social-link" href="https://medium.com/@hugo__df" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 195 195"><path d="M46.5340803,65.2157554 C46.6968378,63.6076572 46.0836,62.018231 44.8828198,60.93592 L32.6512605,46.2010582 L32.6512605,44 L70.6302521,44 L99.9859944,108.380952 L125.794585,44 L162,44 L162,46.2010582 L151.542017,56.2281011 C150.640424,56.9153477 150.193188,58.0448862 150.380019,59.1628454 L150.380019,132.837155 C150.193188,133.955114 150.640424,135.084652 151.542017,135.771899 L161.755369,145.798942 L161.755369,148 L110.38282,148 L110.38282,145.798942 L120.963119,135.527337 C122.002801,134.487948 122.002801,134.182246 122.002801,132.592593 L122.002801,73.0417402 L92.585901,147.755438 L88.6106443,147.755438 L54.3622782,73.0417402 L54.3622782,123.115814 C54.0767278,125.221069 54.7759199,127.3406 56.2581699,128.863022 L70.0186741,145.55438 L70.0186741,147.755438 L31,147.755438 L31,145.55438 L44.7605042,128.863022 C46.2319621,127.338076 46.8903838,125.204485 46.5340803,123.115814 L46.5340803,65.2157554 Z"/></svg></a>
        </div>  
        
        <a class="subscribe-button" href="https://codewithhugo.com/index.xml">Subscribe</a>
            
      </div>

    </nav>  

  </div>
</header>

<main id="site-main" class="site-main outer" role="main">
  <div class="inner">
    
      
<div id="codefund_ad"></div>


<article class="post-full post">
    <header class="post-full-header">
        <section class="post-full-meta">
            <time class="post-full-meta-date" datetime="2018-08-10">10 August 2018</time>
                <span class="date-divider">/</span> <a href="https://codewithhugo.com/tags/testing/">#Testing</a>&nbsp;<a href="https://codewithhugo.com/tags/javascript/">#JavaScript</a>&nbsp;
        </section>
        <h1 class="post-full-title">When to use Jest snapshot tests: comprehensive use-cases and examples 📸</h1>
    </header>
    <div class="hero-container">

      
      <figure class="post-full-image" style="background-image: url(https://codewithhugo.com/img/ben-sauer-unsplash.jpg)">
        

      </figure>
    </div>

    <section class="post-full-content">
        <div class="kg-card-markdown">
        

<p>There&rsquo;s some nice use-cases for snapshot tests outside of the well-travelled React/Vue UI component ones.</p>

<p>In other words, although React and Vue testing with snapshots is pretty well documented, that&rsquo;s not the only place they&rsquo;re useful.</p>

<p>As a rule of thumb, you could replace a lot of unit tests that assert on with specific data with snapshot tests.</p>

<p>We have the following pros for snapshot tests:
- the match data is stored in a separate file so it&rsquo;s harder to lose track of things, eg. being skimmed over during review
- it&rsquo;s a lot less effort to change than inline data matching, just run <code>npx jest -u</code> and all snapshots get updated.</p>

<p>The following cons also come to mind:
- it&rsquo;s a lost less effort to change than inline data matching, which means people need to pay attention to changes in snapshot files
- despite community efforts, the only major test library that supports out of the box is Jest (which locks you into that ecosystem)</p>

<!--
- [authorAvatar: https://cdn-images-1.medium.com/fit/c/200/200/0*Rb-aDjpTtV1UZA4O.jpeg](#authoravatar-httpscdn-images-1mediumcomfitc2002000rb-adjpttv1uza4ojpeg)
- [Config 🎛](#config-)
- [Database Models 🏬](#database-models-)
  - [Setup 🏗](#setup-)
  - [Queries 🔍](#queries-)
- [pug or handlebars templates](#pug-or-handlebars-templates)
- [Gotchas of snapshot testing ⚠️](#gotchas-of-snapshot-testing-️)
  - [Some things (like functions) don’t serialise nicely 🔢](#some-things-like-functions-dont-serialise-nicely-)
  - [If you can do a full match, do it](#if-you-can-do-a-full-match-do-it)
  - [Try to cover the same code/feature with another type of test ✌️](#try-to-cover-the-same-codefeature-with-another-type-of-test-️)
--->

<p>That makes it particularly well-suited for a couple of areas:</p>

<ul>
<li><a href="#config">Config 🎛</a></li>
<li><a href="#database-models">Database Models 🏬</a>

<ul>
<li><a href="#setup">Setup 🏗</a></li>
<li><a href="#queries">Queries 🔍</a></li>
</ul></li>
<li><a href="#pug-or-handlebars-templates">pug or handlebars templates</a></li>
<li><a href="#gotchas-of-snapshot-testing">Gotchas of snapshot testing ⚠️</a>

<ul>
<li><a href="#some-things-like-functions-don-t-serialise-nicely">Some things (like functions) don’t serialise nicely 🔢</a></li>
<li><a href="#if-you-can-do-a-full-match-do-it">If you can do a full match, do it</a></li>
<li><a href="#try-to-cover-the-same-code-feature-with-another-type-of-test">Try to cover the same code/feature with another type of test ✌️</a></li>
</ul></li>
</ul>

<p>Full code is available at <a href="https://github.com/HugoDF/snapshot-everything">github.com/HugoDF/snapshot-everything</a>.</p>

<blockquote>
<p>This was sent out on the <a href="https://buttondown.email/hugo">Code with Hugo newsletter</a> last Monday.
<a href="https://buttondown.email/hugo">Subscribe</a> to get the latest posts right in your inbox (before anyone else).</p>
</blockquote>

<h2 id="config">Config 🎛</h2>

<p><code>monitor-queues.test.js</code>:</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">jest</span><span class="p">.</span><span class="nx">mock</span><span class="p">(</span><span class="s1">&#39;bull-arena&#39;</span><span class="p">);</span>
<span class="k">const</span> <span class="p">{</span> <span class="nx">monitorQueues</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./monitor-queues&#39;</span><span class="p">);</span>
<span class="nx">describe</span><span class="p">(</span><span class="s1">&#39;monitorQueues&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">test</span><span class="p">(</span><span class="s1">&#39;It should return an Arena instance with parsed data from REDIS_URL&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="k">const</span> <span class="nx">redisPort</span> <span class="o">=</span> <span class="mi">5555</span><span class="p">;</span>
    <span class="k">const</span> <span class="nx">REDIS_URL</span> <span class="o">=</span> <span class="sb">`redis://h:passsssword@hosting:</span><span class="si">${</span><span class="nx">redisPort</span><span class="si">}</span><span class="sb">/database-name`</span><span class="p">;</span>
    <span class="k">const</span> <span class="nx">QUEUE_MONITORING_PATH</span> <span class="o">=</span> <span class="s1">&#39;/arena&#39;</span><span class="p">;</span>
    <span class="k">const</span> <span class="nx">ArenaConstructor</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;bull-arena&#39;</span><span class="p">);</span>
    <span class="nx">ArenaConstructor</span><span class="p">.</span><span class="nx">mockReset</span><span class="p">();</span>
    <span class="nx">monitorQueues</span><span class="p">({</span> <span class="nx">REDIS_URL</span><span class="p">,</span> <span class="nx">QUEUE_MONITORING_PATH</span> <span class="p">});</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">ArenaConstructor</span><span class="p">).</span><span class="nx">toHaveBeenCalledTimes</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">ArenaConstructor</span><span class="p">.</span><span class="nx">mock</span><span class="p">.</span><span class="nx">calls</span><span class="p">[</span><span class="mi">0</span><span class="p">]).</span><span class="nx">toMatchSnapshot</span><span class="p">();</span>
  <span class="p">});</span>
  <span class="nx">test</span><span class="p">(</span><span class="s1">&#39;It should return an Arena instance with defaulted redis data when REDIS_URL is empty&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="k">const</span> <span class="nx">REDIS_URL</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
    <span class="k">const</span> <span class="nx">QUEUE_MONITORING_PATH</span> <span class="o">=</span> <span class="s1">&#39;/arena&#39;</span><span class="p">;</span>
    <span class="k">const</span> <span class="nx">ArenaConstructor</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;bull-arena&#39;</span><span class="p">);</span>
    <span class="nx">ArenaConstructor</span><span class="p">.</span><span class="nx">mockReset</span><span class="p">();</span>
    <span class="nx">monitorQueues</span><span class="p">({</span> <span class="nx">REDIS_URL</span><span class="p">,</span> <span class="nx">QUEUE_MONITORING_PATH</span> <span class="p">});</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">ArenaConstructor</span><span class="p">).</span><span class="nx">toHaveBeenCalledTimes</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">ArenaConstructor</span><span class="p">.</span><span class="nx">mock</span><span class="p">.</span><span class="nx">calls</span><span class="p">[</span><span class="mi">0</span><span class="p">]).</span><span class="nx">toMatchSnapshot</span><span class="p">();</span>
  <span class="p">});</span>
<span class="p">});</span>
</code></pre></div>
<p><code>monitor-queues.js</code>:</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="k">const</span> <span class="nx">Arena</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;bull-arena&#39;</span><span class="p">);</span>
<span class="k">const</span> <span class="p">{</span> <span class="nx">JOB_TYPES</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./queue/queues&#39;</span><span class="p">);</span>
<span class="k">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;url&#39;</span><span class="p">);</span>
<span class="kd">function</span> <span class="nx">getRedisConfig</span> <span class="p">(</span><span class="nx">redisUrl</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">const</span> <span class="nx">redisConfig</span> <span class="o">=</span> <span class="nx">url</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">redisUrl</span><span class="p">);</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="nx">host</span><span class="o">:</span> <span class="nx">redisConfig</span><span class="p">.</span><span class="nx">hostname</span> <span class="o">||</span> <span class="s1">&#39;localhost&#39;</span><span class="p">,</span>
    <span class="nx">port</span><span class="o">:</span> <span class="nb">Number</span><span class="p">(</span><span class="nx">redisConfig</span><span class="p">.</span><span class="nx">port</span> <span class="o">||</span> <span class="mi">6379</span><span class="p">),</span>
    <span class="nx">database</span><span class="o">:</span> <span class="p">(</span><span class="nx">redisConfig</span><span class="p">.</span><span class="nx">pathname</span> <span class="o">||</span> <span class="s1">&#39;/0&#39;</span><span class="p">).</span><span class="nx">substr</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">||</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span>
    <span class="nx">password</span><span class="o">:</span> <span class="nx">redisConfig</span><span class="p">.</span><span class="nx">auth</span> <span class="o">?</span> <span class="nx">redisConfig</span><span class="p">.</span><span class="nx">auth</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">:</span> <span class="kc">undefined</span>
  <span class="p">};</span>
<span class="p">}</span>
<span class="k">const</span> <span class="nx">monitorQueues</span> <span class="o">=</span> <span class="p">({</span> <span class="nx">REDIS_URL</span><span class="p">,</span> <span class="nx">QUEUE_MONITORING_PATH</span> <span class="p">})</span> <span class="p">=&gt;</span>
  <span class="nx">Arena</span><span class="p">(</span>
    <span class="p">{</span>
      <span class="nx">queues</span><span class="o">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="nx">name</span><span class="o">:</span> <span class="nx">JOB_TYPES</span><span class="p">.</span><span class="nx">MY_TYPE</span><span class="p">,</span>
          <span class="nx">hostId</span><span class="o">:</span> <span class="s1">&#39;Worker&#39;</span><span class="p">,</span>
          <span class="nx">redis</span><span class="o">:</span> <span class="nx">getRedisConfig</span><span class="p">(</span><span class="nx">REDIS_URL</span><span class="p">)</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nx">basePath</span><span class="o">:</span> <span class="nx">QUEUE_MONITORING_PATH</span><span class="p">,</span>
      <span class="nx">disableListen</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">}</span>
  <span class="p">);</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">monitorQueues</span>
<span class="p">};</span>
</code></pre></div>
<p>Gives the following snapshots:</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">exports</span><span class="p">[</span><span class="sb">`monitorQueues It should return an Arena instance with defaulted redis data when REDIS_URL is empty 1`</span><span class="p">]</span> <span class="o">=</span> <span class="sb">`
</span><span class="sb">Array [
</span><span class="sb">  Object {
</span><span class="sb">    &#34;queues&#34;: Array [
</span><span class="sb">      Object {
</span><span class="sb">        &#34;hostId&#34;: &#34;Worker&#34;,
</span><span class="sb">        &#34;name&#34;: &#34;MY_TYPE&#34;,
</span><span class="sb">        &#34;redis&#34;: Object {
</span><span class="sb">          &#34;database&#34;: &#34;0&#34;,
</span><span class="sb">          &#34;host&#34;: &#34;localhost&#34;,
</span><span class="sb">          &#34;password&#34;: undefined,
</span><span class="sb">          &#34;port&#34;: 6379,
</span><span class="sb">        },
</span><span class="sb">      },
</span><span class="sb">    ],
</span><span class="sb">  },
</span><span class="sb">  Object {
</span><span class="sb">    &#34;basePath&#34;: &#34;/arena&#34;,
</span><span class="sb">    &#34;disableListen&#34;: true,
</span><span class="sb">  },
</span><span class="sb">]
</span><span class="sb">`</span><span class="p">;</span>

<span class="nx">exports</span><span class="p">[</span><span class="sb">`monitorQueues It should return an Arena instance with parsed data from REDIS_URL 1`</span><span class="p">]</span> <span class="o">=</span> <span class="sb">`
</span><span class="sb">Array [
</span><span class="sb">  Object {
</span><span class="sb">    &#34;queues&#34;: Array [
</span><span class="sb">      Object {
</span><span class="sb">        &#34;hostId&#34;: &#34;Worker&#34;,
</span><span class="sb">        &#34;name&#34;: &#34;MY_TYPE&#34;,
</span><span class="sb">        &#34;redis&#34;: Object {
</span><span class="sb">          &#34;database&#34;: &#34;database-name&#34;,
</span><span class="sb">          &#34;host&#34;: &#34;hosting&#34;,
</span><span class="sb">          &#34;password&#34;: &#34;passsssword&#34;,
</span><span class="sb">          &#34;port&#34;: 5555,
</span><span class="sb">        },
</span><span class="sb">      },
</span><span class="sb">    ],
</span><span class="sb">  },
</span><span class="sb">  Object {
</span><span class="sb">    &#34;basePath&#34;: &#34;/arena&#34;,
</span><span class="sb">    &#34;disableListen&#34;: true,
</span><span class="sb">  },
</span><span class="sb">]
</span><span class="sb">`</span><span class="p">;</span>
</code></pre></div>
<h2 id="database-models">Database Models 🏬</h2>

<h3 id="setup">Setup 🏗</h3>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;It should initialise correctly&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="k">class</span> <span class="nx">MockModel</span> <span class="p">{</span> <span class="p">}</span>
  <span class="nx">MockModel</span><span class="p">.</span><span class="nx">init</span> <span class="o">=</span> <span class="nx">jest</span><span class="p">.</span><span class="nx">fn</span><span class="p">();</span>
  <span class="nx">jest</span><span class="p">.</span><span class="nx">setMock</span><span class="p">(</span><span class="s1">&#39;sequelize&#39;</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">Model</span><span class="o">:</span> <span class="nx">MockModel</span>
  <span class="p">});</span>
  <span class="nx">jest</span><span class="p">.</span><span class="nx">resetModuleRegistry</span><span class="p">();</span>
  <span class="k">const</span> <span class="nx">MyModel</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./my-model&#39;</span><span class="p">);</span>
  <span class="k">const</span> <span class="nx">mockSequelize</span> <span class="o">=</span> <span class="p">{};</span>
  <span class="k">const</span> <span class="nx">mockDataTypes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">UUID</span><span class="o">:</span> <span class="s1">&#39;UUID&#39;</span><span class="p">,</span>
    <span class="nx">ENUM</span><span class="o">:</span> <span class="nx">jest</span><span class="p">.</span><span class="nx">fn</span><span class="p">((...</span><span class="nx">arr</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="sb">`ENUM-</span><span class="si">${</span><span class="nx">arr</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="si">}</span><span class="sb">`</span><span class="p">),</span>
    <span class="nx">TEXT</span><span class="o">:</span> <span class="s1">&#39;TEXT&#39;</span><span class="p">,</span>
    <span class="nx">STRING</span><span class="o">:</span> <span class="s1">&#39;STRING&#39;</span>
  <span class="p">};</span>
  <span class="nx">MyModel</span><span class="p">.</span><span class="nx">init</span><span class="p">(</span><span class="nx">mockSequelize</span><span class="p">,</span> <span class="nx">mockDataTypes</span><span class="p">);</span>
  <span class="nx">expect</span><span class="p">(</span><span class="nx">MockModel</span><span class="p">.</span><span class="nx">init</span><span class="p">).</span><span class="nx">toHaveBeenCalledTimes</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
  <span class="nx">expect</span><span class="p">(</span><span class="nx">MockModel</span><span class="p">.</span><span class="nx">init</span><span class="p">.</span><span class="nx">mock</span><span class="p">.</span><span class="nx">calls</span><span class="p">[</span><span class="mi">0</span><span class="p">]).</span><span class="nx">toMatchSnapshot</span><span class="p">();</span>
<span class="p">});</span>
</code></pre></div>
<p><code>my-model.js</code>:</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="k">const</span> <span class="p">{</span> <span class="nx">Model</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;sequelize&#39;</span><span class="p">);</span>

<span class="k">class</span> <span class="nx">MyModel</span> <span class="k">extends</span> <span class="nx">Model</span> <span class="p">{</span>
  <span class="kr">static</span> <span class="nx">init</span> <span class="p">(</span><span class="nx">sequelize</span><span class="p">,</span> <span class="nx">DataTypes</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">super</span><span class="p">.</span><span class="nx">init</span><span class="p">(</span>
      <span class="p">{</span>
        <span class="nx">disputeId</span><span class="o">:</span> <span class="nx">DataTypes</span><span class="p">.</span><span class="nx">UUID</span><span class="p">,</span>
        <span class="nx">type</span><span class="o">:</span> <span class="nx">DataTypes</span><span class="p">.</span><span class="nx">ENUM</span><span class="p">(...[</span><span class="s1">&#39;my&#39;</span><span class="p">,</span> <span class="s1">&#39;enum&#39;</span><span class="p">,</span> <span class="s1">&#39;options&#39;</span><span class="p">]),</span>
        <span class="nx">message</span><span class="o">:</span> <span class="nx">DataTypes</span><span class="p">.</span><span class="nx">TEXT</span><span class="p">,</span>
        <span class="nx">updateCreatorId</span><span class="o">:</span> <span class="nx">DataTypes</span><span class="p">.</span><span class="nx">STRING</span><span class="p">,</span>
        <span class="nx">reply</span><span class="o">:</span> <span class="nx">DataTypes</span><span class="p">.</span><span class="nx">TEXT</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="nx">sequelize</span><span class="p">,</span>
        <span class="nx">hooks</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">afterCreate</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">afterCreate</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">);</span>
  <span class="p">}</span>

  <span class="kr">static</span> <span class="nx">afterCreate</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// do nothing
</span><span class="c1"></span>  <span class="p">}</span>
<span class="p">}</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">MyModel</span><span class="p">;</span>
</code></pre></div>
<p>Gives us the following snapshot:</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">exports</span><span class="p">[</span><span class="sb">`It should initialise correctly 1`</span><span class="p">]</span> <span class="o">=</span> <span class="sb">`
</span><span class="sb">Array [
</span><span class="sb">  Object {
</span><span class="sb">    &#34;disputeId&#34;: &#34;UUID&#34;,
</span><span class="sb">    &#34;message&#34;: &#34;TEXT&#34;,
</span><span class="sb">    &#34;reply&#34;: &#34;TEXT&#34;,
</span><span class="sb">    &#34;type&#34;: &#34;ENUM-my,enum,options&#34;,
</span><span class="sb">    &#34;updateCreatorId&#34;: &#34;STRING&#34;,
</span><span class="sb">  },
</span><span class="sb">  Object {
</span><span class="sb">    &#34;hooks&#34;: Object {
</span><span class="sb">      &#34;afterCreate&#34;: [Function],
</span><span class="sb">    },
</span><span class="sb">    &#34;sequelize&#34;: Object {},
</span><span class="sb">  },
</span><span class="sb">]
</span><span class="sb">`</span><span class="p">;</span>
</code></pre></div>
<h3 id="queries">Queries 🔍</h3>

<p><code>my-model.test.js</code>:</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">jest</span><span class="p">.</span><span class="nx">mock</span><span class="p">(</span><span class="s1">&#39;sequelize&#39;</span><span class="p">);</span>
<span class="k">const</span> <span class="nx">MyModel</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./my-model&#39;</span><span class="p">);</span>

<span class="nx">test</span><span class="p">(</span><span class="s1">&#39;It should call model.findOne with correct order clause&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="k">const</span> <span class="nx">findOneStub</span> <span class="o">=</span> <span class="nx">jest</span><span class="p">.</span><span class="nx">fn</span><span class="p">();</span>
  <span class="k">const</span> <span class="nx">realFindOne</span> <span class="o">=</span> <span class="nx">MyModel</span><span class="p">.</span><span class="nx">findOne</span><span class="p">;</span>
  <span class="nx">MyModel</span><span class="p">.</span><span class="nx">findOne</span> <span class="o">=</span> <span class="nx">findOneStub</span><span class="p">;</span>
  <span class="k">const</span> <span class="nx">mockDb</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">Association</span><span class="o">:</span> <span class="s1">&#39;Association&#39;</span><span class="p">,</span>
    <span class="nx">OtherAssociation</span><span class="o">:</span> <span class="s1">&#39;OtherAssociation&#39;</span><span class="p">,</span>
    <span class="nx">SecondNestedAssociation</span><span class="o">:</span> <span class="s1">&#39;SecondNestedAssociation&#39;</span>
  <span class="p">};</span>
  <span class="nx">MyModel</span><span class="p">.</span><span class="nx">getSomethingWithNestedStuff</span><span class="p">(</span><span class="s1">&#39;1234&#39;</span><span class="p">,</span> <span class="nx">mockDb</span><span class="p">);</span>
  <span class="nx">expect</span><span class="p">(</span><span class="nx">findOneStub</span><span class="p">).</span><span class="nx">toHaveBeenCalled</span><span class="p">();</span>
  <span class="nx">expect</span><span class="p">(</span><span class="nx">findOneStub</span><span class="p">.</span><span class="nx">mock</span><span class="p">.</span><span class="nx">calls</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">].</span><span class="nx">order</span><span class="p">).</span><span class="nx">toMatchSnapshot</span><span class="p">();</span>
  <span class="nx">MyModel</span><span class="p">.</span><span class="nx">findOne</span> <span class="o">=</span> <span class="nx">realFindOne</span><span class="p">;</span>
<span class="p">});</span>
</code></pre></div>
<p><code>my-model.js</code>:</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="k">const</span> <span class="p">{</span> <span class="nx">Model</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;sequelize&#39;</span><span class="p">);</span>

<span class="k">class</span> <span class="nx">MyModel</span> <span class="k">extends</span> <span class="nx">Model</span> <span class="p">{</span>
    <span class="kr">static</span> <span class="nx">getSomethingWithNestedStuff</span><span class="p">(</span><span class="nx">match</span><span class="p">,</span> <span class="nx">db</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">findOne</span><span class="p">({</span>
      <span class="nx">where</span><span class="o">:</span> <span class="p">{</span> <span class="nx">someField</span><span class="o">:</span> <span class="nx">match</span> <span class="p">},</span>
      <span class="nx">attributes</span><span class="o">:</span> <span class="p">[</span>
        <span class="s1">&#39;id&#39;</span><span class="p">,</span>
        <span class="s1">&#39;createdAt&#39;</span><span class="p">,</span>
        <span class="s1">&#39;reason&#39;</span>
      <span class="p">],</span>
      <span class="nx">order</span><span class="o">:</span> <span class="p">[[</span><span class="nx">db</span><span class="p">.</span><span class="nx">Association</span><span class="p">,</span> <span class="nx">db</span><span class="p">.</span><span class="nx">OtherAssociation</span><span class="p">,</span> <span class="s1">&#39;createdAt&#39;</span><span class="p">,</span> <span class="s1">&#39;ASC&#39;</span><span class="p">]],</span>
      <span class="nx">include</span><span class="o">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="nx">model</span><span class="o">:</span> <span class="nx">db</span><span class="p">.</span><span class="nx">Association</span><span class="p">,</span>
          <span class="nx">attributes</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span>
          <span class="nx">include</span><span class="o">:</span> <span class="p">[</span>
            <span class="p">{</span>
              <span class="nx">model</span><span class="o">:</span> <span class="nx">db</span><span class="p">.</span><span class="nx">OtherAssociation</span><span class="p">,</span>
              <span class="nx">attributes</span><span class="o">:</span> <span class="p">[</span>
                <span class="s1">&#39;id&#39;</span><span class="p">,</span>
                <span class="s1">&#39;type&#39;</span><span class="p">,</span>
                <span class="s1">&#39;createdAt&#39;</span>
              <span class="p">],</span>
              <span class="nx">include</span><span class="o">:</span> <span class="p">[</span>
                <span class="p">{</span>
                  <span class="nx">model</span><span class="o">:</span> <span class="nx">db</span><span class="p">.</span><span class="nx">SecondNestedAssociation</span><span class="p">,</span>
                  <span class="nx">attributes</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;fullUrl&#39;</span><span class="p">,</span> <span class="s1">&#39;previewUrl&#39;</span><span class="p">]</span>
                <span class="p">}</span>
              <span class="p">]</span>
            <span class="p">}</span>
          <span class="p">]</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">});</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Gives the following snapshot:</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">exports</span><span class="p">[</span><span class="sb">`It should call model.findOne with correct order clause 1`</span><span class="p">]</span> <span class="o">=</span> <span class="sb">`
</span><span class="sb">Array [
</span><span class="sb">  Array [
</span><span class="sb">    &#34;Association&#34;,
</span><span class="sb">    &#34;OtherAssociation&#34;,
</span><span class="sb">    &#34;createdAt&#34;,
</span><span class="sb">    &#34;ASC&#34;,
</span><span class="sb">  ],
</span><span class="sb">]
</span><span class="sb">`</span><span class="p">;</span>
</code></pre></div>
<h2 id="pug-or-handlebars-templates">pug or handlebars templates</h2>

<p>This is pretty much the same as the Vue/React snapshot testing stuff, but let’s walk through it anyways, we have two equivalent templates in Pug and Handlebars:</p>

<p><code>template.pug</code>:</p>
<div class="highlight"><pre class="chroma"><code class="language-pug" data-lang="pug">section
  h1= myTitle
  p= myText</code></pre></div>
<p><code>template.handlebars</code>:</p>
<div class="highlight"><pre class="chroma"><code class="language-handlebars" data-lang="handlebars"><span class="x">&lt;section&gt;
</span><span class="x">  &lt;h1&gt;</span><span class="cp">{{</span> <span class="nv">myTitle</span> <span class="cp">}}</span><span class="x">&lt;/h1&gt;
</span><span class="x">  &lt;p&gt;</span><span class="cp">{{</span> <span class="nv">myText</span> <span class="cp">}}</span><span class="x">&lt;/p&gt;
</span><span class="x">&lt;/section&gt;</span></code></pre></div>
<p><code>template.test.js</code>:</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="k">const</span> <span class="nx">pug</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;pug&#39;</span><span class="p">);</span>

<span class="k">const</span> <span class="nx">renderPug</span> <span class="o">=</span> <span class="nx">data</span> <span class="p">=&gt;</span> <span class="nx">pug</span><span class="p">.</span><span class="nx">renderFile</span><span class="p">(</span><span class="s1">&#39;./template.pug&#39;</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>

<span class="nx">test</span><span class="p">(</span><span class="s1">&#39;It should render pug correctly&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">expect</span><span class="p">(</span><span class="nx">renderPug</span><span class="p">({</span>
    <span class="nx">myTitle</span><span class="o">:</span> <span class="s1">&#39;Pug&#39;</span><span class="p">,</span>
    <span class="nx">myText</span><span class="o">:</span> <span class="s1">&#39;Pug is great&#39;</span>
  <span class="p">})).</span><span class="nx">toMatchSnapshot</span><span class="p">();</span>
<span class="p">});</span>

<span class="k">const</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">);</span>
<span class="k">const</span> <span class="nx">Handlebars</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;handlebars&#39;</span><span class="p">);</span>
<span class="k">const</span> <span class="nx">renderHandlebars</span> <span class="o">=</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">compile</span><span class="p">(</span><span class="nx">fs</span><span class="p">.</span><span class="nx">readFileSync</span><span class="p">(</span><span class="s1">&#39;./template.handlebars&#39;</span><span class="p">,</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">));</span>

<span class="nx">test</span><span class="p">(</span><span class="s1">&#39;It should render handlebars correctly&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">expect</span><span class="p">(</span><span class="nx">renderHandlebars</span><span class="p">({</span>
    <span class="nx">myTitle</span><span class="o">:</span> <span class="s1">&#39;Handlebars&#39;</span><span class="p">,</span>
    <span class="nx">myText</span><span class="o">:</span> <span class="s1">&#39;Handlebars is great&#39;</span>
  <span class="p">})).</span><span class="nx">toMatchSnapshot</span><span class="p">();</span>
<span class="p">});</span>
</code></pre></div>
<p>The bulk of the work here actually compiling the template to a string with the raw compiler for pug and handlebars.</p>

<p>The snapshots end up being pretty straightforward:</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">exports</span><span class="p">[</span><span class="sb">`It should render pug correctly 1`</span><span class="p">]</span> <span class="o">=</span> <span class="sb">`&#34;&lt;section&gt;&lt;h1&gt;Pug&lt;/h1&gt;&lt;p&gt;Pug is great&lt;/p&gt;&lt;/section&gt;&#34;`</span><span class="p">;</span>

<span class="nx">exports</span><span class="p">[</span><span class="sb">`It should render handlebars correctly 1`</span><span class="p">]</span> <span class="o">=</span> <span class="sb">`
</span><span class="sb">&#34;&lt;section&gt;
</span><span class="sb">  &lt;h1&gt;Handlebars&lt;/h1&gt;
</span><span class="sb">  &lt;p&gt;Handlebars is great&lt;/p&gt;
</span><span class="sb">&lt;/section&gt;
</span><span class="sb">&#34;
</span><span class="sb">`</span><span class="p">;</span>
</code></pre></div>
<h2 id="gotchas-of-snapshot-testing">Gotchas of snapshot testing ⚠️</h2>

<h3 id="some-things-like-functions-don-t-serialise-nicely">Some things (like functions) don’t serialise nicely 🔢</h3>

<p>See in <code>__snapshots__/my-model.test.js.snap</code>:</p>
<div class="highlight"><pre class="chroma"><code class="language-json" data-lang="json"><span class="s2">&#34;hooks&#34;</span><span class="err">:</span> <span class="err">Object</span> <span class="p">{</span>
  <span class="nt">&#34;afterCreate&#34;</span><span class="p">:</span> <span class="p">[</span><span class="err">Function</span><span class="p">],</span>
<span class="p">}</span><span class="err">,</span></code></pre></div>
<p>We should really add a line like the following to test that this function <em>is</em> actually the correct function, (<code>my-model.test.js</code>):</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">expect</span><span class="p">(</span><span class="nx">MockModel</span><span class="p">.</span><span class="nx">init</span><span class="p">.</span><span class="nx">mock</span><span class="p">.</span><span class="nx">calls</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">].</span><span class="nx">hooks</span><span class="p">.</span><span class="nx">afterCreate</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="nx">MockModel</span><span class="p">.</span><span class="nx">afterCreate</span><span class="p">);</span>
</code></pre></div>
<h3 id="if-you-can-do-a-full-match-do-it">If you can do a full match, do it</h3>

<p>A lot of the time, a hard assertion with an object match is a good fit, don&rsquo;t just take a snapshot because you can.</p>

<p>You should take snapshots for things that pretty much aren&rsquo;t the core purpose of the code, eg. strings in a rendered template, the DOM structure in a rendered template, configs.</p>

<p>The tradeoff with snapshots is the following:</p>

<blockquote>
<p>A snapshot gives you a weaker assertion than an inline <code>toBe</code> or <code>toEqual</code> does,
but it&rsquo;s also a lot less effort in terms of code typed and information stored in the test
(and therefore reduces complexity).</p>
</blockquote>

<h3 id="try-to-cover-the-same-code-feature-with-another-type-of-test">Try to cover the same code/feature with another type of test ✌️</h3>

<p>Whether that&rsquo;s a manual smoke test that <code>/arena</code> <em>is</em> actually loading up the Bull Arena queue monitoring, or integration tests over the whole app, you should still check that things work 🙂.</p>

<p>Full code is available at <a href="https://github.com/HugoDF/snapshot-everything">github.com/HugoDF/snapshot-everything</a>.</p>

<p><a style="background-color:black;color:white;text-decoration:none;padding:4px 6px;font-family:-apple-system, BlinkMacSystemFont, &quot;San Francisco&quot;, &quot;Helvetica Neue&quot;, Helvetica, Ubuntu, Roboto, Noto, &quot;Segoe UI&quot;, Arial, sans-serif;font-size:12px;font-weight:bold;line-height:1.2;display:inline-block;border-radius:3px" href="https://unsplash.com/@sauer?utm_medium=referral&amp;utm_campaign=photographer-credit&amp;utm_content=creditBadge" target="_blank" rel="noopener noreferrer" title="Download free do whatever you want high-resolution photos from Ben Sauer"><span style="display:inline-block;padding:2px 3px"><svg xmlns="http://www.w3.org/2000/svg" style="height:12px;width:auto;position:relative;vertical-align:middle;top:-1px;fill:white" viewBox="0 0 32 32"><title>unsplash-logo</title><path d="M20.8 18.1c0 2.7-2.2 4.8-4.8 4.8s-4.8-2.1-4.8-4.8c0-2.7 2.2-4.8 4.8-4.8 2.7.1 4.8 2.2 4.8 4.8zm11.2-7.4v14.9c0 2.3-1.9 4.3-4.3 4.3h-23.4c-2.4 0-4.3-1.9-4.3-4.3v-15c0-2.3 1.9-4.3 4.3-4.3h3.7l.8-2.3c.4-1.1 1.7-2 2.9-2h8.6c1.2 0 2.5.9 2.9 2l.8 2.4h3.7c2.4 0 4.3 1.9 4.3 4.3zm-8.6 7.5c0-4.1-3.3-7.5-7.5-7.5-4.1 0-7.5 3.4-7.5 7.5s3.3 7.5 7.5 7.5c4.2-.1 7.5-3.4 7.5-7.5z"></path></svg></span><span style="display:inline-block;padding:2px 3px">Ben Sauer</span></a></p>

        </div>
    </section>

    <section class="subscribe-form">
        <h3 class="subscribe-form-title">Subscribe to Code with Hugo</h3>
        <p>Get all the posts of the week before anyone else in your inbox</p>
        <form
            action="https://buttondown.email/api/emails/embed-subscribe/hugo"
            method="post"
            target="popupwindow"
            onsubmit="window.open('https://buttondown.email/hugo', 'popupwindow')"
        >
            <div class="form-group">
                <input class="subscribe-email" type="email" name="email" id="bd-email" placeholder="youremail@example.com">
                <input type="hidden" value="1" name="embed"/>
            </div>
            <button class="" value="Subscribe" type="submit"><span>Subscribe</span></button>
        </form>
    </section>

    <footer class="post-full-footer">
      <section class="author-card">
        <img class="author-profile-image" src="https://cdn-images-1.medium.com/fit/c/200/200/0*Rb-aDjpTtV1UZA4O.jpeg" alt="Author" />
        <section class="author-card-content">
            <h4 class="author-card-name"><a href="https://codewithhugo.com/">Hugo Di Francesco</a></h4>
                <p>A developer, working out of London writing CSS, JavaScript and Python.</p>
        </section>
      </section>
    </footer>
</article>


  <section class="overlay-cta">
    <div class="overlay-cta__inner">
      <div class="overlay-cta__text-container">
        <h3 class="cta-title overlay-cta__title">
          Subscribe to the Code with Hugo newsletter
        </h3>
        <p class="cta-text overlay-cta__text">
          Get the best and latest articles in your inbox every week
        </p>
      </div>
      <div class="overlay-cta__button-container">
        <a href="https://buttondown.email/hugo" class="button overlay-cta__button">
          Subscribe
        </a>
        <a href="#" class="overlay-cta__close">close</a>
      </div>
    </div>
  </section>



    
    
    

  </div>
</main>


<aside class="read-next outer">
  <div class="inner">
    <div class="read-next-feed">      
      
<article class="read-next-card" 
            style="background-image: url(https://codewithhugo.com/img/cover.jpg);" >
    <header class="read-next-card-header">
        <small class="read-next-card-header-sitetitle">&mdash; Code with Hugo &mdash;</small>
        
        <h3 class="read-next-card-header-title"><a href="https://codewithhugo.com/tags/testing/">#Testing</a></h3>
    </header>
    <div class="read-next-divider"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14.5s2 3 5 3 5.5-2.463 5.5-5.5S21 6.5 18 6.5c-5 0-7 11-12 11C2.962 17.5.5 15.037.5 12S3 6.5 6 6.5s4.5 3.5 4.5 3.5"/></svg>
    </div>

    <div class="read-next-card-content">
      
        <ul>
          <li><a href="https://codewithhugo.com/why-you-should-wrap-your-javascript-dependencies/">Why you should wrap your (JavaScript) dependencies</a></li>            
        
          <li><a href="https://codewithhugo.com/closures-partial-application-and-currying-effective-functional-javascript/">Closures, Partial Application and Currying: Effective Functional JavaScript</a></li>            
        
          <li><a href="https://codewithhugo.com/build-and-deploy-a-vue/react/vanilla-js-app-with-parcel-and-github-pages/">Build and deploy a Vue/React/Vanilla JS app with Parcel and GitHub pages</a></li>            
        
          <li><a href="https://codewithhugo.com/ava-low-config-testing-for-javascript/">AVA, low-config testing for JavaScript</a></li>            
        </ul>
    </div>
    <footer class="read-next-card-footer">
      
        <a href="https://codewithhugo.com/tags/testing/">See all related posts →</a>
    </footer>
</article>


      
      <article class="post-card post"> 
    
    <a class="post-card-image-link" href="https://codewithhugo.com/simple-but-not-too-simple-how-using-zeits-micro-improves-your-node-applications/">
      <div class="post-card-image" style="background-image: url(https://codewithhugo.com/img/kelly-sikkema-unsplash.jpg)"></div>
    </a>
    

    <div class="post-card-content">
      <a class="post-card-content-link" href="https://codewithhugo.com/simple-but-not-too-simple-how-using-zeits-micro-improves-your-node-applications/">
          <header class="post-card-header">
              <span class="post-card-tags">
              #JavaScript 
              #Node 
              #ES6 
              #architecture  </span>
              
              <h2 class="post-card-title">Simple, but not too simple: how using Zeit’s `micro` improves your Node applications</h2>
          </header>
          <section class="post-card-excerpt">
              
                <p>Leave the Express comfort zone to expand how you think about Node application architecture.
 tl;dr
 using a function composition model for building HTTP servers is awesome Functions as a Service are great but have some drawbacks micro has a similar, simple API to FaaS but doesn&rsquo;t have a compilation step micro&rsquo;s minimalism affects how you solve problems
 Functions as a composition model for JavaScript
 Functions as a Service pain points ...  </p>
              
          </section>
      </a>

      <footer class="post-card-meta">
          <img class="author-profile-image" src="https://cdn-images-1.medium.com/fit/c/200/200/0*Rb-aDjpTtV1UZA4O.jpeg" alt="Author" />
          <span class="post-card-author"><a href="/">Hugo Di Francesco</a></span>
      </footer>
    </div>
</article>
      
      
      <article class="post-card post"> 
    
    <a class="post-card-image-link" href="https://codewithhugo.com/deploy-to-multiple-environments-with-git-and-circleci/">
      <div class="post-card-image" style="background-image: url(https://codewithhugo.com/img/oliver-roos-unsplash.jpg)"></div>
    </a>
    

    <div class="post-card-content">
      <a class="post-card-content-link" href="https://codewithhugo.com/deploy-to-multiple-environments-with-git-and-circleci/">
          <header class="post-card-header">
              <span class="post-card-tags">
              #tooling 
              #git 
              #ci 
              #bash  </span>
              
              <h2 class="post-card-title">Deploy to multiple environments with git and CircleCI</h2>
          </header>
          <section class="post-card-excerpt">
              
                <p>Easily deploying to multiple environments in a simple manner using GitHub, CircleCI and Heroku.
Continuous Integration is awesome, but sometimes you need a buffer between auto-deploying things on merge and the production release. To do that with CircleCI requires some git branch-wrangling and a few lines of bash scripting. We’ll imagine a scenario where a deploy is trivial (ie. we’ll pretend we’re using Heroku). For more complicated build steps we should still be able to follow similar principles. ...  </p>
              
          </section>
      </a>

      <footer class="post-card-meta">
          <img class="author-profile-image" src="https://cdn-images-1.medium.com/fit/c/200/200/0*Rb-aDjpTtV1UZA4O.jpeg" alt="Author" />
          <span class="post-card-author"><a href="/">Hugo Di Francesco</a></span>
      </footer>
    </div>
</article>
      
    </div>
  </div>
</aside>

<div class="floating-header">
  <div class="floating-header-logo">
    <a href="https://codewithhugo.com/">
      
      <span>Code with Hugo</span>
    </a>
  </div>
  <span class="floating-header-divider">&mdash;</span>
  <div class="floating-header-title">When to use Jest snapshot tests: comprehensive use-cases and examples 📸</div>
  <div class="floating-header-share">
    <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
     <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"/></svg>
    </div>

    
    <a class="floating-header-share-tw" href="https://twitter.com/share?text=%22When%20to%20use%20Jest%20snapshot%20tests%3a%20comprehensive%20use-cases%20and%20examples%20%f0%9f%93%b8%22%20by%20%40hugo__df&amp;url=https%3a%2f%2fcodewithhugo.com%2fabusing-jest-snapshot-tests-some-nice-use-cases-%2f&amp"
          onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>
      </a>
      <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fcodewithhugo.com%2fabusing-jest-snapshot-tests-some-nice-use-cases-%2f"
          onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>
      </a>
  </div>

  <progress class="progress" value="0">
    <div class="progress-container">
      <span class="progress-bar"></span>
    </div>
  </progress>
</div>



<footer class="site-footer outer">
  <div class="site-footer-content inner">
    <section class="copyright" style="line-height: 1.3em;">
      <a href="/">Code with Hugo</a>  <br>
      
    </section>
    <nav class="site-footer-nav">
        <a href="/">Latest Posts</a>
        
        <a href="https://twitter.com/hugo__df" target="_blank" rel="noopener">Twitter</a>
        <a href="https://github.com/HugoDF" target="_blank" rel="noopener">Github</a>
        
        <a href="https://medium.com/@hugo__df" target="_blank" rel="noopener">Medium</a>
    </nav>  
  </div>
</footer>

</div>

<script type="text/javascript" src="//code.jquery.com/jquery-3.2.1.min.js"></script>
<script type="text/javascript" src="https://codewithhugo.com/js/jquery.fitvids.js"></script>




  <!-- Google Analytics -->
  <script>
    var _gaq=[['_setAccount','UA-60469708-1'],['_trackPageview']];
    (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
    g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
    s.parentNode.insertBefore(g,s)}(document,'script'));
  </script>



<script async src="//cdn.simpleanalytics.io/hello.js"></script>
<noscript><img src="//api.simpleanalytics.io/hello.gif" alt=""></noscript>





<script>
  (function (document) {
    function getLastDocumentHeight(document) {
      var body = document.body;
      var html = document.documentElement;
      return Math.max(
        body.scrollHeight, body.offsetHeight,
        html.clientHeight, html.scrollHeight,
        html.offsetHeight
      );
    }

    var $overlay = document.querySelector('.overlay-cta');
    var hiddenClass = 'overlay-cta--hidden';
    var closedClass = 'overlay-cta--closed';
    $overlay.classList.add(hiddenClass);

    
    var $overlayClose = document.querySelector('.overlay-cta__close');
    var overlayCloseListener = $overlayClose.addEventListener('click', function (e) {
      e.preventDefault();
      $overlay.classList.add(closedClass);
    });

    var $heroCtaButton = document.querySelector('.hero-cta .button');
    var $firstContentItem = document.querySelector('.post-full-content > * > *');
    var title = $heroCtaButton || $firstContentItem;

    var $subscribeBox = document.querySelector('.subscribe-form');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = getLastDocumentHeight(document);
    var ticking = false;


    function onScroll() {
      lastScrollY = window.scrollY;
      requestTick();
    }

    function onResize() {
      lastWindowHeight = window.innerHeight;
      lastDocumentHeight = getLastDocumentHeight(document);
      requestTick();
    }

    function requestTick() {
      if (!ticking) {
        requestAnimationFrame(update);
      }
      ticking = true;
    }

    function update() {
      var trigger = title.getBoundingClientRect().top + window.scrollY;
      var triggerOffset = title.offsetHeight + 35;
      var lastShowCtaBoxHeight = $subscribeBox.getBoundingClientRect().top ;
      
      if (
        lastScrollY >= trigger + triggerOffset &&
        lastShowCtaBoxHeight > lastWindowHeight
      ) {
        $overlay.classList.remove(hiddenClass);
      } else {
        $overlay.classList.add(hiddenClass);
      }

      ticking = false;
    }

    window.addEventListener('scroll', onScroll, { passive: true });
    window.addEventListener('resize', onResize, false);

    update();
  })(document);
</script>


    <script>





$(document).ready(function () {
    
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
    

    var progressBar = document.querySelector('progress');
    var header = document.querySelector('.floating-header');
    var title = document.querySelector('.post-full-title');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = $(document).height();
    var ticking = false;

    function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
    }

    function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
    }

    function requestTick() {
        if (!ticking) {
            requestAnimationFrame(update);
        }
        ticking = true;
    }

    function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 35;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        
        if (lastScrollY >= trigger + triggerOffset) {
            header.classList.add('floating-active');
        } else {
            header.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;
    }

    window.addEventListener('scroll', onScroll, {passive: true});
    window.addEventListener('resize', onResize, false);

    update();
});
</script>
</body></html>
